$&&$((function(){(()=>{"use strict";const e=function(e,o,r){if("number"!=typeof o)return;const t=Math.max(Math.min(o,.9),.1);r&&e.attr("class","e2-progress e2-progress_notransition"),e[0].style.strokeDashoffset=Math.floor(245-245*t),r&&e.attr("class","e2-progress")};const o=function(o,r){const t=o.find("animateTransform"),s=o.find("circle.e2-progress");t.length&&(r?"indefinite"!==t[0].getAttribute("repeatCount")&&(t[0].setAttribute("repeatCount","indefinite"),t[0].beginElement()):t[0].setAttribute("repeatCount","1"),s.length&&e(s,0,!0))};const r=function(){var e,o=document.createElement("div"),r={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"};for(e in r)if(void 0!==o.style[e])return r[e];return!1};const t=function(e){var o,t,s,a,n=$(".e2-nice-error"),i=n.find(".e2-nice-error-inner"),d="e2-nice-error_hidden",l={en:{"er--js-server-error":"Server error","er--js-appears-offline":"The connection appears to be offline","er--js-connection-timeout":"Server does not respond for too long","er--js-file-upload-not-supported":"The browser does not support file upload","er--js-no-files-to-upload":"No files to upload","er--js-can-upload-only-one-file":"Only one file may be uploaded here","er--supported-image-types":"Supported image types:","er--supported-file-types":"Supported file types:"},ru:{"er--js-server-error":"Ошибка на сервере","er--js-appears-offline":"Похоже, что нет интернета","er--js-connection-timeout":"Сервер не отвечает слишком долго","er--js-file-upload-not-supported":"Браузер не поддерживает загрузку файлов","er--js-no-files-to-upload":"Нет файлов для загрузки","er--js-can-upload-only-one-file":"Можно загрузить только одно изображение","er--supported-image-types":"Поддерживаемые типы изображений:","er--supported-file-types":"Поддерживаемые типы файлов:"},fr:{"er--js-server-error":"Erreur sur le serveur","er--js-appears-offline":"La connexion semble être hors ligne","er--js-connection-timeout":"Le serveur ne répond pas trop longtemps","er--js-file-upload-not-supported":"Le navigateur ne prend pas en charge le téléchargement de fichiers","er--js-no-files-to-upload":"Aucun fichier à télécharger","er--js-can-upload-only-one-file":"Un seul fichier peut être téléchargé ici","er--supported-image-types":"Types d’image pris en charge :","er--supported-file-types":"Types de fichiers pris en charge :"},it:{"er--js-server-error":"Errore sul server","er--js-appears-offline":"La connessione sembra di mancare","er--js-connection-timeout":"Il server non risponde per troppo tempo","er--js-file-upload-not-supported":"Il navigatore web non supporta caricamento dei fili","er--js-no-files-to-upload":"Non ci sono fili da caricare","er--js-can-upload-only-one-file":"Solo un file può essere caricato qui","er--supported-image-types":"Tipi di immagine supportati:","er--supported-file-types":"Tipi di file supportati:"},be:{"er--js-server-error":"Памылка на серверы","er--js-appears-offline":"Падобна на тое, што няма інтэрнэту","er--js-connection-timeout":"Сервер не адказвае занадта доўга","er--js-file-upload-not-supported":"Браузэр не падтрымлівае загрузку файлаў","er--js-no-files-to-upload":"Няма файлаў для загрузкі","er--js-can-upload-only-one-file":"Можна загрузіць толькі адну выяву","er--supported-image-types":"Падтрымлiваемыя тыпы выяў:","er--supported-file-types":"Падтрымлiваемыя тыпы файлаў:"},uk:{"er--js-server-error":"Помилка на сервері","er--js-appears-offline":"Схоже, що немає інтернету","er--js-connection-timeout":"Сервер не відповідає занадто довго","er--js-file-upload-not-supported":"Браузер не підтримує завантаження файлів","er--js-no-files-to-upload":"Немає файлів для завантаження","er--js-can-upload-only-one-file":"Можна завантажити лише одне зображення","er--supported-image-types":"Підтримувані типи зображень:","er--supported-file-types":"Підтримувані типи файлів:"}},p=r();function u(e){"function"==typeof e?p?(n.off(p+".e2NiceError").on(p+".e2NiceError",(function(){n.off(p+".e2NiceError"),e()})),n.addClass(d)):(n.addClass(d),e()):n.addClass(d)}s=e.message?e.message:"",a=$("html").attr("lang")||"en",s&&(void 0!==l[a]&&void 0!==l[a][e.message]?s=l[a][e.message]:void 0!==l.en[e.message]&&(s=l.en[e.message]),n.hasClass(d)?i.html(s).promise().done((function(){n.removeClass(d),$(document).on("mousedown.e2NiceError keydown.e2NiceError",(function(){$(document).off(".e2NiceError"),u()}))})):u((function(){i.html(s).promise().done((function(){n.removeClass(d),$(document).on("mousedown.e2NiceError keydown.e2NiceError",(function(){$(document).off(".e2NiceError"),u()}))}))}))),"object"==typeof e.debug&&"object"==typeof console&&("function"==typeof window.getComputedStyle&&"function"==typeof window.getComputedStyle(document.documentElement).getPropertyValue&&(o=window.getComputedStyle(document.documentElement).getPropertyValue("--errorColor"),t=window.getComputedStyle(document.documentElement).getPropertyValue("--backgroundColor")),"function"==typeof console.log&&("string"==typeof e.debug.message?console.log("%c "+e.debug.message+" ","background: "+(o||"#D20D19")+"; color: "+(t||"#fff")+";"):"string"==typeof s&&console.log("%c "+s+" ","background: "+(o||"#D20D19")+"; color: "+(t||"#fff")+";")),"function"==typeof console.dir&&"function"==typeof console.log&&"object"==typeof e.debug.data&&$.each(e.debug.data,(function(e,o){if("object"==typeof o&&o instanceof FormData&&"function"==typeof o.entries)for(var r of(console.log(e),o.entries()))console.dir(r[1]);else console.log(e),console.dir(o)})))};const s=function(e){var o=e.success,r=e.error,s=e.complete,a=e.abort;delete e.success,delete e.error,delete e.complete,delete e.abort;var n=document.querySelector('meta[name="csrf-token"]'),i=n&&n.content?n.content:null;i&&(e.data=function(e,o){return o?void 0!==window.FormData&&e instanceof window.FormData?("function"==typeof e.has&&e.has("token")||e.append("token",o),e):null==e?{token:o}:"string"==typeof e?(/(?:^|&)token=/.test(e)||(e+=(e.length?"&":"")+"token="+encodeURIComponent(o)),e):Array.isArray(e)?(e.some((function(e){return e&&"token"===e.name}))||e.push({name:"token",value:o}),e):"object"==typeof e?(Object.prototype.hasOwnProperty.call(e,"token")||(e.token=o),e):e:e}(e.data,i));var d=$.ajax($.extend({type:"post",timeout:1e4,dataType:"json",cache:!1},e));return d.done((function(s,a,n){if("object"==typeof s)if(!0===s.success)"function"==typeof o&&o(s,a,n);else{if("object"==typeof s.error){var i=s.error,d="string"==typeof i.message?i.message:"er--js-server-error";t({message:d,debug:{data:{requestData:e.data,response:s}}})}else t({message:"er--js-server-error",debug:{message:"Server responce malformed: `response.error` is not an object",data:{requestData:e.data,response:s}}});"function"==typeof r&&r(n,a)}else t({message:"er--js-server-error",debug:{message:"Server responce malformed: `response` is not an object",data:{requestData:e.data,response:s}}}),"function"==typeof r&&r(n,a)})),d.fail((function(e,o){if("object"==typeof e&&"number"==typeof e.status&&"string"==typeof o)if(0===e.status){if("abort"===o)return"function"==typeof a&&a(e,o),!1;t("timeout"===o?{message:"er--js-connection-timeout"}:{message:"er--js-appears-offline"})}else e.status>=400?t({message:"er--js-server-error",debug:{message:"Server responded with HTTP status code "+e.status,data:{jqXHR:e}}}):200===e.status&&"parsererror"===o?t({message:"er--js-server-error",debug:{message:"Server response is not JSON",data:{jqXHR:e}}}):t({message:"er--js-server-error",debug:{message:"Unexpected server response HTTP status code "+e.status,data:{jqXHR:e}}});else t({message:"er--js-server-error",debug:{message:"Server responce malformed: jqXHR is not an object or it does not contain required fields",data:{jqXHR:e}}});"function"==typeof r&&r(e,o)})),d.always((function(){"function"==typeof s&&s(arguments)})),d};var a,n,i=null,d=0,l=!1,p=!1,u=!0,f=$(".e2-ajax-loading"),c="e2-ajax-loading_hidden",m="form-element-toggled_hidden",g=$("#form-install"),b=g.find("#submit-button"),v=g.find("#db-server"),y=g.find("#db-user"),j=g.find("#db-password"),h=g.find("#db-database"),w=h.parents(".form-element-toggled"),C=g.find("#db-database-list"),k=C.parents(".form-element-toggled"),T=g.find("#password");function E(){b.prop("disabled",!l||/^ *$/.test(T.val())),b.hide().show(0)}function S(){a&&a.abort(),n&&n.abort(),Boolean(d)===k.hasClass(m)&&k.add(w).toggleClass(m),u=!1}function D(){if($(".db-everything-ok").removeClass("e2-verified").addClass("e2-wrong"),void 0===p.data||!p.data["db-responding"])return!1;$(".db-server-ok").removeClass("e2-wrong").addClass("e2-verified"),u&&y.focus(),p.data["db-connected"]&&($(".db-user-password-ok").removeClass("e2-wrong").addClass("e2-verified"),p.data["db-found"]&&($(".db-database-ok").removeClass("e2-wrong").addClass("e2-verified"),$("#db-database-message-text").text(p.data.message),p.data.message?$("#db-database-message").slideDown(200):$("#db-database-message").slideUp(200),p.data["db-compatible"]&&p.data["db-good"]&&($(".db-everything-ok").removeClass("e2-wrong").addClass("e2-verified"),u&&T.focus())))}function N(){var e,r;d=0,o(f,1),f.removeClass(c);var m={"db-server":v.val(),"db-user":y.val(),"db-password":j.val(),"db-database":h.val()};v.data("e2OldValue",m["db-server"]),y.data("e2OldValue",m["db-user"]),j.data("e2OldValue",m["db-password"]),h.data("e2OldValue",m["db-database"]),C.data("e2OldValue",m["db-database"]),i&&clearTimeout(i),i=setTimeout((function(){a&&a.abort(),n&&n.abort(),a=s({url:g.attr("data-action-database-config"),data:m,success:function(o){if(void 0===o.data)return t({message:"er--js-server-error",debug:{message:"Server response malformed",data:{response:o}}}),!1;p=o,D(),p.data["db-connected"]?(a&&a.abort(),n&&n.abort(),n=s({url:g.attr("data-action-databases-list"),data:m,success:function(e){if(void 0===e.data||void 0===e.data["databases-list"])return t({message:"er--js-server-error",debug:{message:"Server response malformed",data:{response:e}}}),!1;var o=e.data["databases-list"],r=h.val();if(""===h.val())h.val(o[0]);else for(var s in o)if(o[s].match(RegExp("^"+h.val()))){h.val(o[s]);break}if(C.empty(),o.length){for(var a in o){++d;var n="";o[a]===h.val()&&(n=" selected"),C.append("<option"+n+">"+o[a]+"</option>")}h.val(C.find("option:selected").val()),C.addClass("e2-verified"),r!==h.val()&&N()}},error:function(){u&&h.focus()},complete:function(){r=!0,e&&r&&S()}})):r=!0,l=p.data["db-good"],E()},error:function(){u&&($(".input-editable").prop("disabled",!1),v.add(y).add(j).add(h).val(""),v.focus(),u=!1)},complete:function(){$(".input-editable").prop("disabled",!1),(e=!0)&&r&&S(),o(f,0),f.addClass(c)}})}),333)}C.on("change",(function(){h.val(C.val()),N()})),$(".e2-livecheckable").on("input",(function(){l=!1,$(".db-everything-ok").removeClass("e2-verified").removeClass("e2-wrong"),E()})).on("blur",(function(){var e=$(this),o=$(this).val();void 0!==e.data("e2OldValue")&&o===e.data("e2OldValue")?D():(e.removeClass("e2-verified").removeClass("e2-wrong"),N())})),T.on("input",E),$(".input-editable").prop("disabled",!0),N()})()}));